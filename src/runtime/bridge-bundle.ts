/**
 * Auto-generated bridge bundle
 * DO NOT EDIT - Generated by build/bundle-bridge.ts
 */
export const BRIDGE_BUNDLE = "// Verdex Bridge Bundle v0.1.6\n// Generated: 2025-11-30T22:06:38.108Z\n\"use strict\";(()=>{var w=Object.defineProperty;var L=(d,e,t)=>e in d?w(d,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):d[e]=t;var g=(d,e,t)=>L(d,typeof e!=\"symbol\"?e+\"\":e,t);var f=class{static getRole(e){let t=this.getExplicitRole(e);if(t){if(t===\"none\"||t===\"presentation\"){let r=this.getImplicitRole(e);if(this.hasPresentationConflictResolution(e))return r||\"generic\"}return t}return this.getImplicitRole(e)||\"generic\"}static getExplicitRole(e){let t=e.getAttribute(\"role\");return t&&t.split(/\\s+/).map(n=>n.trim()).find(n=>this.VALID_ROLES.includes(n))||null}static getImplicitRole(e){switch(e.tagName.toUpperCase()){case\"A\":return e.hasAttribute(\"href\")?\"link\":null;case\"AREA\":return e.hasAttribute(\"href\")?\"link\":null;case\"ARTICLE\":return\"article\";case\"ASIDE\":return\"complementary\";case\"BLOCKQUOTE\":return\"blockquote\";case\"BUTTON\":return\"button\";case\"CAPTION\":return\"caption\";case\"CODE\":return\"code\";case\"DATALIST\":return\"listbox\";case\"DD\":return\"definition\";case\"DEL\":return\"deletion\";case\"DETAILS\":return\"group\";case\"DFN\":return\"term\";case\"DIALOG\":return\"dialog\";case\"DT\":return\"term\";case\"EM\":return\"emphasis\";case\"FIELDSET\":return\"group\";case\"FIGURE\":return\"figure\";case\"FOOTER\":return this.isInLandmarkContext(e)?null:\"contentinfo\";case\"FORM\":return this.hasAccessibleName(e)?\"form\":null;case\"H1\":case\"H2\":case\"H3\":case\"H4\":case\"H5\":case\"H6\":return\"heading\";case\"HEADER\":return this.isInLandmarkContext(e)?null:\"banner\";case\"HR\":return\"separator\";case\"HTML\":return\"document\";case\"IFRAME\":return\"iframe\";case\"IMG\":return e.getAttribute(\"alt\")===\"\"&&!e.getAttribute(\"title\")&&!this.hasGlobalAriaAttribute(e)?\"presentation\":\"img\";case\"INPUT\":return this.getInputRole(e);case\"INS\":return\"insertion\";case\"LI\":return\"listitem\";case\"MAIN\":return\"main\";case\"MARK\":return\"mark\";case\"MATH\":return\"math\";case\"MENU\":return\"list\";case\"METER\":return\"meter\";case\"NAV\":return\"navigation\";case\"OL\":return\"list\";case\"OPTGROUP\":return\"group\";case\"OPTION\":return\"option\";case\"OUTPUT\":return\"status\";case\"P\":return\"paragraph\";case\"PROGRESS\":return\"progressbar\";case\"SEARCH\":return\"search\";case\"SECTION\":return this.hasAccessibleName(e)?\"region\":null;case\"SELECT\":return e.multiple||e.size>1?\"listbox\":\"combobox\";case\"STRONG\":return\"strong\";case\"SUB\":return\"subscript\";case\"SUP\":return\"superscript\";case\"SVG\":return\"img\";case\"TABLE\":return\"table\";case\"TBODY\":return\"rowgroup\";case\"TD\":return this.isInGridContext(e)?\"gridcell\":\"cell\";case\"TEXTAREA\":return\"textbox\";case\"TFOOT\":return\"rowgroup\";case\"TH\":return e.getAttribute(\"scope\")===\"col\"?\"columnheader\":e.getAttribute(\"scope\")===\"row\"?\"rowheader\":this.isInGridContext(e)?\"gridcell\":\"cell\";case\"THEAD\":return\"rowgroup\";case\"TIME\":return\"time\";case\"TR\":return\"row\";case\"UL\":return\"list\";default:return null}}static getInputRole(e){switch(e.type.toLowerCase()){case\"search\":return e.hasAttribute(\"list\")?\"combobox\":\"searchbox\";case\"email\":case\"tel\":case\"text\":case\"url\":case\"\":return e.list?\"combobox\":\"textbox\";case\"hidden\":return\"none\";case\"file\":return\"button\";case\"button\":case\"image\":case\"reset\":case\"submit\":return\"button\";case\"checkbox\":return\"checkbox\";case\"radio\":return\"radio\";case\"range\":return\"slider\";case\"number\":return\"spinbutton\";default:return\"textbox\"}}static hasAccessibleName(e){return e.hasAttribute(\"aria-label\")||e.hasAttribute(\"aria-labelledby\")||e.hasAttribute(\"title\")}static hasGlobalAriaAttribute(e){return[\"aria-atomic\",\"aria-busy\",\"aria-controls\",\"aria-current\",\"aria-describedby\",\"aria-details\",\"aria-dropeffect\",\"aria-flowto\",\"aria-grabbed\",\"aria-hidden\",\"aria-keyshortcuts\",\"aria-label\",\"aria-labelledby\",\"aria-live\",\"aria-owns\",\"aria-relevant\",\"aria-roledescription\"].some(r=>e.hasAttribute(r))}static isInLandmarkContext(e){return!!e.closest(\"article, aside, main, nav, section, [role=article], [role=complementary], [role=main], [role=navigation], [role=region]\")}static isInGridContext(e){let t=e.closest(\"table\");if(!t)return!1;let r=this.getExplicitRole(t);return r===\"grid\"||r===\"treegrid\"}static hasPresentationConflictResolution(e){return this.hasGlobalAriaAttribute(e)||this.isFocusable(e)}static isFocusable(e){if(e.hasAttribute(\"tabindex\")){let r=parseInt(e.getAttribute(\"tabindex\")||\"0\",10);return!isNaN(r)}let t=e.tagName.toUpperCase();return[\"BUTTON\",\"DETAILS\",\"SELECT\",\"TEXTAREA\"].includes(t)?!e.disabled:t===\"A\"||t===\"AREA\"?e.hasAttribute(\"href\"):t===\"INPUT\"?!e.disabled&&e.type!==\"hidden\":!1}static getName(e){let t=this.getRole(e);if(this.NAMING_PROHIBITED_ROLES.includes(t))return\"\";let r=e.getAttribute(\"aria-labelledby\");if(r){let o=r.split(/\\s+/).map(a=>document.getElementById(a)).filter(a=>a!==null).map(a=>this.getTextContent(a)).filter(a=>a.length>0);if(o.length>0)return o.join(\" \").trim()}let n=e.getAttribute(\"aria-label\");if(n&&n.trim())return n.trim();let i=this.getNativeLabel(e);if(i)return i;if(this.NAME_FROM_CONTENT_ROLES.includes(t)){let o=this.getTextContent(e);if(o)return o}let s=e.getAttribute(\"title\");if(s&&s.trim())return s.trim();if(e.tagName===\"INPUT\"||e.tagName===\"TEXTAREA\"){let o=e.getAttribute(\"placeholder\");if(o&&o.trim())return o.trim()}return\"\"}static getNativeLabel(e){let t=e.tagName.toUpperCase();if([\"INPUT\",\"TEXTAREA\",\"SELECT\"].includes(t)){let r=e.id;if(r){let i=document.querySelector(`label[for=\"${r}\"]`);if(i)return this.getTextContent(i)}let n=e.closest(\"label\");if(n)return this.getTextContent(n)}if(t===\"IMG\"){let r=e.getAttribute(\"alt\");if(r!==null)return r}return\"\"}static getTextContent(e){if(e instanceof HTMLInputElement){if([\"submit\",\"reset\",\"button\"].includes(e.type))return e.value||e.type;if(e.type===\"image\")return e.alt||e.value||\"Submit\"}return e instanceof HTMLButtonElement,e.textContent?.trim()||\"\"}static getAriaProperties(e,t){let r={};if([\"checkbox\",\"radio\",\"menuitemcheckbox\",\"menuitemradio\",\"option\",\"switch\"].includes(t)){let l=e.getAttribute(\"aria-checked\");l===\"mixed\"?r.checked=\"mixed\":l===\"true\"?r.checked=!0:l===\"false\"?r.checked=!1:e instanceof HTMLInputElement&&(r.checked=e.checked)}if([\"button\",\"checkbox\",\"combobox\",\"gridcell\",\"link\",\"listbox\",\"menuitem\",\"menuitemcheckbox\",\"menuitemradio\",\"option\",\"radio\",\"searchbox\",\"slider\",\"spinbutton\",\"switch\",\"tab\",\"textbox\",\"treeitem\"].includes(t)&&(e.getAttribute(\"aria-disabled\")===\"true\"?r.disabled=!0:(e instanceof HTMLInputElement||e instanceof HTMLButtonElement||e instanceof HTMLSelectElement||e instanceof HTMLTextAreaElement)&&(r.disabled=e.disabled)),[\"button\",\"combobox\",\"gridcell\",\"link\",\"menuitem\",\"row\",\"rowheader\",\"tab\",\"treeitem\"].includes(t)){let l=e.getAttribute(\"aria-expanded\");l===\"true\"?r.expanded=!0:l===\"false\"&&(r.expanded=!1)}if([\"heading\",\"listitem\",\"row\",\"treeitem\"].includes(t)){let l=e.getAttribute(\"aria-level\");if(l){let m=parseInt(l,10);isNaN(m)||(r.level=m)}else t===\"heading\"&&/^H[1-6]$/.test(e.tagName)&&(r.level=parseInt(e.tagName[1],10))}if([\"button\"].includes(t)){let l=e.getAttribute(\"aria-pressed\");l===\"mixed\"?r.pressed=\"mixed\":l===\"true\"?r.pressed=!0:l===\"false\"&&(r.pressed=!1)}if([\"gridcell\",\"option\",\"row\",\"tab\",\"treeitem\"].includes(t)){let l=e.getAttribute(\"aria-selected\");l===\"true\"?r.selected=!0:l===\"false\"&&(r.selected=!1)}return r.active=document.activeElement===e,r}static isVisibleForAria(e){if(this.IGNORED_ELEMENTS.includes(e.tagName))return!1;let t=e;for(;t;){if(t.getAttribute(\"aria-hidden\")===\"true\")return!1;t=t.parentElement}return this.isElementVisible(e)}static isElementVisible(e){let t=e;for(;t;){let r=window.getComputedStyle(t);if(r.display===\"none\"||r.display===\"contents\"&&t.nodeName!==\"SLOT\"&&!Array.from(t.children).some(i=>this.isElementVisible(i))||r.visibility===\"hidden\"&&!(t.tagName===\"OPTION\"&&t.closest(\"select\")))return!1;t=t.parentElement}return!(e.parentElement?.shadowRoot&&!e.assignedSlot)}static isInteractive(e,t){let n=window.getComputedStyle(e).pointerEvents!==\"none\",i=this.isFocusable(e),s=this.INTERACTIVE_ROLES.includes(t),o=this.INTERACTIVE_ELEMENTS.includes(e.tagName);return n&&(i||s||o)}};g(f,\"VALID_ROLES\",[\"alert\",\"alertdialog\",\"application\",\"article\",\"banner\",\"blockquote\",\"button\",\"caption\",\"cell\",\"checkbox\",\"code\",\"columnheader\",\"combobox\",\"complementary\",\"contentinfo\",\"definition\",\"deletion\",\"dialog\",\"directory\",\"document\",\"emphasis\",\"feed\",\"figure\",\"form\",\"generic\",\"grid\",\"gridcell\",\"group\",\"heading\",\"img\",\"insertion\",\"link\",\"list\",\"listbox\",\"listitem\",\"log\",\"main\",\"mark\",\"marquee\",\"math\",\"meter\",\"menu\",\"menubar\",\"menuitem\",\"menuitemcheckbox\",\"menuitemradio\",\"navigation\",\"none\",\"note\",\"option\",\"paragraph\",\"presentation\",\"progressbar\",\"radio\",\"radiogroup\",\"region\",\"row\",\"rowgroup\",\"rowheader\",\"scrollbar\",\"search\",\"searchbox\",\"separator\",\"slider\",\"spinbutton\",\"status\",\"strong\",\"subscript\",\"superscript\",\"switch\",\"tab\",\"table\",\"tablist\",\"tabpanel\",\"term\",\"textbox\",\"time\",\"timer\",\"toolbar\",\"tooltip\",\"tree\",\"treegrid\",\"treeitem\"]),g(f,\"NAME_FROM_CONTENT_ROLES\",[\"button\",\"cell\",\"checkbox\",\"columnheader\",\"gridcell\",\"heading\",\"link\",\"menuitem\",\"menuitemcheckbox\",\"menuitemradio\",\"option\",\"radio\",\"row\",\"rowheader\",\"switch\",\"tab\",\"tooltip\",\"treeitem\"]),g(f,\"NAMING_PROHIBITED_ROLES\",[\"caption\",\"code\",\"definition\",\"deletion\",\"emphasis\",\"generic\",\"insertion\",\"mark\",\"paragraph\",\"presentation\",\"strong\",\"subscript\",\"superscript\",\"term\",\"time\"]),g(f,\"INTERACTIVE_ROLES\",[\"button\",\"link\",\"textbox\",\"checkbox\",\"radio\",\"combobox\",\"listbox\",\"menuitem\",\"menuitemcheckbox\",\"menuitemradio\",\"tab\",\"switch\",\"slider\",\"spinbutton\",\"searchbox\",\"option\"]),g(f,\"IGNORED_ELEMENTS\",[\"SCRIPT\",\"STYLE\",\"NOSCRIPT\",\"TEMPLATE\"]),g(f,\"INTERACTIVE_ELEMENTS\",[\"A\",\"BUTTON\",\"INPUT\",\"SELECT\",\"TEXTAREA\",\"DETAILS\",\"IFRAME\"]);var A=class{constructor(e,t={}){g(this,\"bridge\");g(this,\"config\");g(this,\"visited\",new Set);this.bridge=e,this.config=t}generate(){console.log(\"Starting snapshot...\");try{for(let[n,i]of this.bridge.elements.entries())i.element.isConnected||(delete i.element._verdexRef,this.bridge.elements.delete(n));this.visited.clear();let t={role:\"WebArea\",name:\"\",children:this.buildAriaTree(document.body,!0),element:document.body};this.normalizeGenericRoles(t);let r=[];return this.renderTree(t,r,\"\"),{text:r.join(`\n`),elementCount:this.bridge.elements.size}}catch(e){return console.error(\"Snapshot error:\",e),{text:`Error: ${e.message}`,elementCount:0}}}buildAriaTree(e,t){if(this.visited.has(e))return[];if(this.visited.add(e),e.nodeType===Node.TEXT_NODE&&e.nodeValue){if(!t)return[];let o=this.normalizeWhitespace(e.nodeValue);if(o&&o.length>0){let a=e.parentElement;if(a&&f.getRole(a)!==\"textbox\")return[o]}return[]}if(e.nodeType!==Node.ELEMENT_NODE)return[];let r=e,n=f.isVisibleForAria(r);if(!n)return this.buildChildrenTree(r,!1);let i=this.createAriaNode(r);if(!i)return this.buildChildrenTree(r,n);let s=this.getInputValue(r);if(s!==null&&s.length>0){i.children=[s];let o=this.buildAriaOwnedTree(r);i.children.push(...o)}else{let o=this.buildChildrenTree(r,n),a=this.buildAriaOwnedTree(r);i.children=[...o,...a]}return[i]}createAriaNode(e){let t=f.getRole(e);if(!t||t===\"presentation\"||t===\"none\")return null;let r=f.getName(e),n=f.getAriaProperties(e,t);if(t===\"generic\"){let s=window.getComputedStyle(e);if((s.display===\"inline\"||s.display===\"inline-block\")&&e.childNodes.length===1&&e.childNodes[0].nodeType===Node.TEXT_NODE)return null}let i={role:t,name:r,children:[],element:e,...n};if(this.extractElementProperties(e,i),f.isInteractive(e,t)){let s=e._verdexRef;s&&this.bridge.elements.has(s)||(s=`e${++this.bridge.counter}`,e._verdexRef=s),i.ref=s;let o={element:e,tagName:e.tagName,role:t,name:r,attributes:this.bridge.getAttributes(e)};this.bridge.elements.set(s,o)}return i}buildNodeLine(e,t){let r=`${t}- ${e.role}`;if(e.name&&(r+=` ${this.yamlEscapeValueIfNeeded(e.name)}`),e.checked===\"mixed\"?r+=\" [checked=mixed]\":e.checked===!0&&(r+=\" [checked]\"),e.disabled&&(r+=\" [disabled]\"),e.expanded&&(r+=\" [expanded]\"),e.active&&(r+=\" [active]\"),e.level&&(r+=` [level=${e.level}]`),e.pressed===\"mixed\"?r+=\" [pressed=mixed]\":e.pressed===!0&&(r+=\" [pressed]\"),e.selected&&(r+=\" [selected]\"),e.props&&Object.keys(e.props).length>0){let n=Object.entries(e.props).map(([i,s])=>`${i}=\"${s.replace(/\"/g,'\\\\\"')}\"`).join(\" \");r+=` [${n}]`}return e.ref&&(r+=` [ref=${e.ref}]`),r}extractElementProperties(e,t){let r={};if(t.role===\"link\"&&e.hasAttribute(\"href\")&&(r.url=e.getAttribute(\"href\")),t.role===\"textbox\"||t.role===\"searchbox\"){let n=e.getAttribute(\"placeholder\");n&&(r.placeholder=n)}if(e instanceof HTMLImageElement&&e.src&&(r.src=e.src),t.role===\"button\"){let n=e.getAttribute(\"type\");(n===\"submit\"||n===\"reset\")&&(r.type=n)}if(t.role===\"combobox\"){let n=e.getAttribute(\"autocomplete\");n&&(r.autocomplete=n)}Object.keys(r).length>0&&(t.props=r)}getInputValue(e){return!(e instanceof HTMLInputElement||e instanceof HTMLTextAreaElement)||e instanceof HTMLInputElement&&[\"checkbox\",\"radio\",\"file\",\"button\",\"submit\",\"reset\",\"image\",\"hidden\"].includes(e.type)?null:e.value}buildChildrenTree(e,t){let r=[];if(t){let n=this.getCSSContent(e,\"::before\");n&&r.push(n)}if(e.nodeName===\"SLOT\"){let i=e.assignedNodes();if(i.length>0){if(i.forEach(s=>{r.push(...this.buildAriaTree(s,t))}),t){let s=this.getCSSContent(e,\"::after\");s&&r.push(s)}return r}}if(Array.from(e.childNodes).forEach(n=>{n.assignedSlot||r.push(...this.buildAriaTree(n,t))}),e.shadowRoot&&Array.from(e.shadowRoot.childNodes).forEach(n=>{r.push(...this.buildAriaTree(n,t))}),t){let n=this.getCSSContent(e,\"::after\");n&&r.push(n)}return r}buildAriaOwnedTree(e){let t=e.getAttribute(\"aria-owns\");if(!t)return[];let r=t.split(/\\s+/).map(i=>document.getElementById(i)).filter(i=>i!==null),n=[];return r.forEach(i=>{n.push(...this.buildAriaTree(i,!0))}),n}normalizeGenericRoles(e){let t=[];for(let n of e.children||[]){if(typeof n==\"string\"){t.push(n);continue}let i=this.normalizeGenericRoles(n);t.push(...i)}return e.role===\"generic\"&&!e.name&&!e.ref&&t.length===1?t:(e.children=t,[e])}renderTree(e,t,r){if(typeof e==\"string\"){let i=this.yamlEscapeValueIfNeeded(e);t.push(`${r}- text: ${i}`);return}if(e.role===\"WebArea\"){for(let i of e.children)this.renderTree(i,t,r);return}let n=this.buildNodeLine(e,r);t.push(n);for(let i of e.children)this.renderTree(i,t,r+\"  \")}normalizeWhitespace(e){return e.replace(/[\\u200b\\u00ad]/g,\"\").replace(/[\\r\\n\\s\\t]+/g,\" \").trim()}getCSSContent(e,t){let n=window.getComputedStyle(e,t).content;if(!n||n===\"none\"||n===\"normal\")return\"\";let i=n.replace(/^[\"']|[\"']$/g,\"\");return i=i.replace(/\\\\([0-9a-fA-F]{1,6})\\s?/g,(s,o)=>String.fromCharCode(parseInt(o,16))),i}yamlEscapeKeyIfNeeded(e){return/[:\\[\\]{}#&*!|>'\"%@`]/.test(e)||e.startsWith(\"-\")?JSON.stringify(e):e}yamlEscapeValueIfNeeded(e){return e?/^(true|false|null|~)$/i.test(e)||/^[0-9]/.test(e)||/[:\\[\\]{}#&*!|>'\"%@`\\n\\r]/.test(e)?JSON.stringify(e):e:'\"\"'}};var p=class{static buildShallowOutline(e,t=6,r){let n=[],i=new Set,s=[\":scope > h1\",\":scope > h2\",\":scope > h3\",\":scope > h4\",\":scope > h5\",\":scope > h6\",\":scope > button\",\":scope > a\",\":scope > label\",\":scope > [data-testid]\",\":scope > span\",\":scope > strong\",\":scope > em\"].join(\",\"),o=Array.from(e.querySelectorAll(s)),a;if(r){let c=new Set(o);a=new Map,r.forEach(l=>{c.has(l.element)&&a.set(l.element,l)})}for(let c of o){if(n.length>=t)break;let l=c.getAttribute(\"role\")||void 0,m,h=a?.get(c);h&&(l=l||h.role||void 0,m=h.name||void 0);let N=l?.toLowerCase(),u=c.tagName?.toLowerCase(),T=(c.textContent||\"\").trim(),R=c.getAttribute(\"data-testid\")||void 0,S=c.getAttribute(\"aria-label\")||void 0,y=(T&&T.length<=200?T:void 0)||m||S;if(!y&&!R&&!N)continue;let C=`${N||u}|${y||\"\"}|${R||\"\"}`;i.has(C)||(i.add(C),n.push({role:l,tag:u,text:y,testid:R}))}return n}static getRelevantAttributes(e){let t={};return this.RELEVANT_ATTRIBUTES.forEach(r=>{let n=e.getAttribute(r);n&&(t[r]=n)}),t}static findContainedRefs(e,t){let r=[];return t.forEach((n,i)=>{e.contains(n.element)&&n.element!==e&&r.push(i)}),r}static extractMeaningfulTexts(e){let t=[],r=document.createTreeWalker(e,NodeFilter.SHOW_TEXT|NodeFilter.SHOW_ELEMENT,{acceptNode:s=>{if(s.nodeType===Node.TEXT_NODE){let o=s.textContent?.trim();if(o&&o.length>0)return NodeFilter.FILTER_ACCEPT}else if(s.nodeType===Node.ELEMENT_NODE){let o=s;if(this.SEMANTIC_ELEMENTS.includes(o.tagName))return NodeFilter.FILTER_ACCEPT}return NodeFilter.FILTER_SKIP}}),n;for(;n=r.nextNode();)if(n.nodeType===Node.TEXT_NODE){let s=n.textContent?.trim();s&&s.length>0&&t.push(s)}else if(n.nodeType===Node.ELEMENT_NODE){let s=n.textContent?.trim();s&&s.length>0&&t.push(s)}return[...new Set(t)].filter(s=>s.length>1&&s.trim().length>0)}static getAllAttributes(e){let t={};for(let r=0;r<e.attributes.length;r++){let n=e.attributes[r];t[n.name]=n.value}return t}static getSiblingIndex(e){return e.parentElement?Array.from(e.parentElement.children).indexOf(e):0}static findParentRef(e,t){let r=e.parentElement;for(;r;){for(let[n,i]of t.entries())if(i.element===r)return n;r=r.parentElement}return null}};g(p,\"RELEVANT_ATTRIBUTES\",[\"class\",\"id\",\"data-testid\",\"role\",\"aria-label\"]),g(p,\"SEMANTIC_ELEMENTS\",[\"H1\",\"H2\",\"H3\",\"H4\",\"H5\",\"H6\",\"BUTTON\",\"A\",\"LABEL\"]);var b=class{constructor(e,t={}){g(this,\"bridge\");g(this,\"config\");this.bridge=e,this.config=t}resolveContainer(e){let t=this.bridge.elements.get(e);if(!t)throw new Error(`Element ${e} not found in bridge elements map`);let r=[],n=t.element.parentElement,i=1;for(;n&&n!==document.body;){let s={level:i,tagName:n.tagName.toLowerCase(),attributes:p.getRelevantAttributes(n),childElements:n.children.length,containsRefs:p.findContainedRefs(n,this.bridge.elements)};r.push(s),n=n.parentElement,i++}return{target:{ref:e,tagName:t.tagName.toLowerCase(),text:t.element.textContent?.trim()||\"\"},ancestors:r}}inspectPattern(e,t){let r=this.bridge.elements.get(e);if(!r)throw new Error(`Element ${e} not found in bridge elements map`);let n=r.element;for(let c=0;c<t;c++){if(!n?.parentElement||n.parentElement===document.body)throw new Error(`Ancestor level ${t} is too high - reached document.body at level ${c+1}`);n=n.parentElement}if(!n)throw new Error(`Failed to find container at ancestor level ${t}`);let i=r.element;for(let c=0;c<Math.max(t-1,0)&&i?.parentElement;c++)i=i.parentElement;let s=i&&i instanceof Element&&i.parentElement===n?i:null,o=s&&n?Array.from(n.children).indexOf(s):null,a=Array.from(n.children).map((c,l)=>({index:l,tagName:c.tagName.toLowerCase(),attributes:p.getRelevantAttributes(c),containsRefs:p.findContainedRefs(c,this.bridge.elements),containsText:p.extractMeaningfulTexts(c),outline:p.buildShallowOutline(c,this.config.maxOutlineItems??6,this.bridge.elements)}));return{ancestorLevel:t,containerAt:{tagName:n.tagName.toLowerCase(),attributes:p.getRelevantAttributes(n)},targetSiblingIndex:o,siblings:a}}extractAnchors(e,t){let r=this.bridge.elements.get(e);if(!r)throw new Error(`Element ${e} not found in bridge elements map`);let n=r.element;for(let a=0;a<t;a++){if(!n.parentElement||n.parentElement===document.body)throw new Error(`Ancestor level ${t} is too high - reached document.body at level ${a+1}`);n=n.parentElement}let i=this.config.maxDepth??4,s=this.traverseDescendants(n,i,0,0),o=0;if(s&&s.length>0){let a=s.map(c=>c?.depth||1);o=Math.max(...a)}return{ancestorAt:{level:t,tagName:n.tagName.toLowerCase(),attributes:p.getRelevantAttributes(n)},descendants:s||[],totalDescendants:s?s.length:0,maxDepthReached:o}}traverseDescendants(e,t=4,r=0,n=0){let i=this.config.maxDescendants??100;if(r>=t||!e?.children||n>=i)return[];let s=[],o=this.config.maxSiblings??15;return Array.from(e.children).slice(0,o).forEach((a,c)=>{let l={depth:r+1,index:c,tagName:a.tagName.toLowerCase(),attributes:p.getRelevantAttributes(a)},m=Array.from(this.bridge.elements.entries()).find(([u,T])=>T.element===a)?.[0];if(m){l.ref=m;let u=this.bridge.elements.get(m);u&&(l.role=u.role,l.name=u.name)}let h=a?.childNodes?Array.from(a.childNodes).filter(u=>u.nodeType===Node.TEXT_NODE).map(u=>u.textContent?.trim()).filter(u=>u&&u.length>0).join(\" \"):\"\";if(h&&h.length>0&&h.length<200&&(l.directText=h),[\"H1\",\"H2\",\"H3\",\"H4\",\"H5\",\"H6\",\"P\",\"SPAN\",\"LABEL\",\"BUTTON\",\"A\"].includes(a.tagName)){let u=a.textContent?.trim();u&&u.length>0&&u.length<200&&u!==h&&(l.fullText=u)}if(a?.children&&a.children.length>0){l.childCount=a.children.length;let u=this.traverseDescendants(a,t,r+1,n+s.length);u&&u.length>0&&(l.descendants=u)}s.push(l)}),s}};var E=class extends Error{constructor(t,r){super(`Element ${t} (${r.role} \"${r.name}\") was removed from DOM. Take a new snapshot() to refresh refs.`);this.ref=t;this.elementInfo=r;this.name=\"StaleRefError\"}},x=class extends Error{constructor(t){super(`Unknown element reference: ${t}. Ref may be stale after navigation. Take a new snapshot to get fresh refs.`);this.ref=t;this.name=\"UnknownRefError\"}};var I=class{static create(e={}){let t=n=>{let i=r.elements.get(n);if(!i)throw new x(n);if(!i.element.isConnected)throw r.elements.delete(n),new E(n,{role:i.role,name:i.name,tagName:i.tagName});return i.element},r={elements:new Map,counter:0,snapshot(){return new A(this,e).generate()},click(n){t(n).click()},type(n,i){let o=t(n);o.focus(),o.value=i,o.dispatchEvent(new Event(\"input\",{bubbles:!0})),o.dispatchEvent(new Event(\"change\",{bubbles:!0}))},resolve_container(n){return t(n),new b(this,e).resolveContainer(n)},inspect_pattern(n,i){return t(n),new b(this,e).inspectPattern(n,i)},extract_anchors(n,i){return t(n),new b(this,e).extractAnchors(n,i)},getAttributes(n){return p.getAllAttributes(n)}};return r}};var v=\"0.1.6\";function O(d){return I.create(d)}function ee(){let d=globalThis.__VerdexBridgeFactory__;if(!d)throw new Error(\"Verdex bridge factory not initialized\");return d}(function(){let e=Object.freeze({create:O,version:v}),t=globalThis.__VerdexBridgeFactory__;(!t||t.version!==v)&&(t&&delete globalThis.__VerdexBridgeFactory__,Object.defineProperty(globalThis,\"__VerdexBridgeFactory__\",{value:e,writable:!1,enumerable:!1,configurable:!0}))})();})();\n";
export const BRIDGE_VERSION = "0.1.6";
